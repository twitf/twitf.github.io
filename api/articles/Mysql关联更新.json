{"title":"MySQL关联更新","uid":"506c801d029fc82da00b47467cf26e6d","slug":"Mysql关联更新","date":"2022-04-15T03:44:34.000Z","updated":"2023-09-12T01:17:19.035Z","comments":true,"path":"api/articles/Mysql关联更新.json","keywords":null,"cover":null,"content":"<h2 id=\"MySQL关联更新\"><a href=\"#MySQL关联更新\" class=\"headerlink\" title=\"MySQL关联更新\"></a>MySQL关联更新</h2><div class=\"language-sql\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">sql</span><pre class=\"shiki One Dark Pro\" style=\"background-color: #282c34\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #C678DD\">UPDATE</span><span style=\"color: #ABB2BF\"> sfc_kpi_user_calibration_import_copy2 </span><span style=\"color: #C678DD\">as</span><span style=\"color: #ABB2BF\"> i,sfc_kpi_user </span><span style=\"color: #C678DD\">as</span><span style=\"color: #ABB2BF\"> u  </span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">SET</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #D19A66\">i</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #D19A66\">be_evaluate_user_id</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #D19A66\">u</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #D19A66\">user_id</span><span style=\"color: #ABB2BF\">  </span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">WHERE</span><span style=\"color: #ABB2BF\">  </span></span>\n<span class=\"line\"><span style=\"color: #D19A66\">i</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #D19A66\">be_employee_number</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #D19A66\">u</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #D19A66\">employee_number</span><span style=\"color: #ABB2BF\">  </span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">and</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #D19A66\">u</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #D19A66\">type</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #D19A66\">0</span></span></code></pre></div><h2 id=\"查询统计\"><a href=\"#查询统计\" class=\"headerlink\" title=\"查询统计\"></a>查询统计</h2><div class=\"language-sql\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">sql</span><pre class=\"shiki One Dark Pro\" style=\"background-color: #282c34\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #C678DD\">SELECT</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    *,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #56B6C2\">CONCAT</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #56B6C2\">ROUND</span><span style=\"color: #ABB2BF\">((</span><span style=\"color: #98C379\">`好评`</span><span style=\"color: #ABB2BF\">/</span><span style=\"color: #98C379\">`总数`</span><span style=\"color: #ABB2BF\">)*</span><span style=\"color: #D19A66\">100</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #D19A66\">2</span><span style=\"color: #ABB2BF\">),</span><span style=\"color: #98C379\">&#39;%&#39;</span><span style=\"color: #ABB2BF\">) </span><span style=\"color: #C678DD\">as</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #98C379\">&#39;好评率&#39;</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #56B6C2\">CONCAT</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #56B6C2\">ROUND</span><span style=\"color: #ABB2BF\">((</span><span style=\"color: #98C379\">`中评`</span><span style=\"color: #ABB2BF\">/</span><span style=\"color: #98C379\">`总数`</span><span style=\"color: #ABB2BF\">)*</span><span style=\"color: #D19A66\">100</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #D19A66\">2</span><span style=\"color: #ABB2BF\">),</span><span style=\"color: #98C379\">&#39;%&#39;</span><span style=\"color: #ABB2BF\">) </span><span style=\"color: #C678DD\">as</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #98C379\">&#39;中评率&#39;</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #56B6C2\">CONCAT</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #56B6C2\">ROUND</span><span style=\"color: #ABB2BF\">((</span><span style=\"color: #98C379\">`差评`</span><span style=\"color: #ABB2BF\">/</span><span style=\"color: #98C379\">`总数`</span><span style=\"color: #ABB2BF\">)*</span><span style=\"color: #D19A66\">100</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #D19A66\">2</span><span style=\"color: #ABB2BF\">),</span><span style=\"color: #98C379\">&#39;%&#39;</span><span style=\"color: #ABB2BF\">) </span><span style=\"color: #C678DD\">as</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #98C379\">&#39;差评率&#39;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">FROM</span><span style=\"color: #ABB2BF\"> (</span><span style=\"color: #C678DD\">SELECT</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #98C379\">`被评估人`</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #98C379\">`被评估人工号`</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #98C379\">`被评估人一级部门`</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #98C379\">`被评估人管理层级`</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #98C379\">`图谱中线的颜色`</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #56B6C2\">SUM</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #C678DD\">IF</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">`图谱中线的颜色`</span><span style=\"color: #56B6C2\">=</span><span style=\"color: #98C379\">&#39;好评&#39;</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #D19A66\">1</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\">)) </span><span style=\"color: #C678DD\">as</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #98C379\">&#39;好评&#39;</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #56B6C2\">SUM</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #C678DD\">IF</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">`图谱中线的颜色`</span><span style=\"color: #56B6C2\">=</span><span style=\"color: #98C379\">&#39;中评&#39;</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #D19A66\">1</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\">)) </span><span style=\"color: #C678DD\">as</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #98C379\">&#39;中评&#39;</span><span style=\"color: #ABB2BF\">, </span></span>\n<span class=\"line\"><span style=\"color: #56B6C2\">SUM</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #C678DD\">IF</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">`图谱中线的颜色`</span><span style=\"color: #56B6C2\">=</span><span style=\"color: #98C379\">&#39;差评&#39;</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #D19A66\">1</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\">)) </span><span style=\"color: #C678DD\">as</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #98C379\">&#39;差评&#39;</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">(</span><span style=\"color: #56B6C2\">SUM</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #C678DD\">IF</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">`图谱中线的颜色`</span><span style=\"color: #56B6C2\">=</span><span style=\"color: #98C379\">&#39;好评&#39;</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #D19A66\">1</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\">))+ </span><span style=\"color: #56B6C2\">SUM</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #C678DD\">IF</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">`图谱中线的颜色`</span><span style=\"color: #56B6C2\">=</span><span style=\"color: #98C379\">&#39;中评&#39;</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #D19A66\">1</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\">))+</span><span style=\"color: #56B6C2\">SUM</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #C678DD\">IF</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">`图谱中线的颜色`</span><span style=\"color: #56B6C2\">=</span><span style=\"color: #98C379\">&#39;差评&#39;</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #D19A66\">1</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\">))) </span><span style=\"color: #C678DD\">as</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #98C379\">&#39;总数&#39;</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">FROM</span><span style=\"color: #ABB2BF\"> sheet1 </span><span style=\"color: #C678DD\">GROUP BY</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #98C379\">`被评估人`</span><span style=\"color: #ABB2BF\">) </span><span style=\"color: #C678DD\">as</span><span style=\"color: #ABB2BF\"> a </span></span></code></pre></div>","text":"MySQL关联更新sqlUPDATE sfc_kpi_user_calibration_import_copy2 as i,sfc_kpi_user as u ...","permalink":"/post/Mysql关联更新","photos":[],"count_time":{"symbolsCount":792,"symbolsTime":"1 mins."},"categories":[{"name":"MySQL","slug":"MySQL","count":3,"path":"api/categories/MySQL.json"}],"tags":[{"name":"MySQL","slug":"MySQL","count":2,"path":"api/tags/MySQL.json"},{"name":"MySQL Update","slug":"MySQL-Update","count":1,"path":"api/tags/MySQL-Update.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#MySQL%E5%85%B3%E8%81%94%E6%9B%B4%E6%96%B0\"><span class=\"toc-text\">MySQL关联更新</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%9F%A5%E8%AF%A2%E7%BB%9F%E8%AE%A1\"><span class=\"toc-text\">查询统计</span></a></li></ol>","author":{"name":"Twitf","slug":"blog-author","avatar":"/img/avatar.png","link":"/","description":"<p>To Win In The Future.</p> <p>赢<b>在</b>未来。</p>","socials":{"github":"https://github.com/twitf","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"Docker 常用镜像部署","uid":"75dacad14e098df2be0901cfbf963953","slug":"Docker 常用镜像部署","date":"2022-04-15T03:50:34.000Z","updated":"2023-01-31T06:48:29.638Z","comments":true,"path":"api/articles/Docker 常用镜像部署.json","keywords":null,"cover":null,"text":"docker rabbitmqbashdocker run --privileged --restart=always -it -d --hostname=ra...","permalink":"/post/Docker 常用镜像部署","photos":[],"count_time":{"symbolsCount":"1.1k","symbolsTime":"1 mins."},"categories":[{"name":"Docker","slug":"Docker","count":2,"path":"api/categories/Docker.json"}],"tags":[{"name":"Docker","slug":"Docker","count":2,"path":"api/tags/Docker.json"},{"name":"DockerImages","slug":"DockerImages","count":1,"path":"api/tags/DockerImages.json"}],"author":{"name":"Twitf","slug":"blog-author","avatar":"/img/avatar.png","link":"/","description":"<p>To Win In The Future.</p> <p>赢<b>在</b>未来。</p>","socials":{"github":"https://github.com/twitf","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"《高性能MySQL》读书笔记","uid":"d8586c48f2df198b0f29249f0375488d","slug":"Mysql高性能笔记","date":"2018-11-10T10:55:00.000Z","updated":"2022-10-11T03:38:11.244Z","comments":true,"path":"api/articles/Mysql高性能笔记.json","keywords":null,"cover":null,"text":"第1章 MySQL架构与历史下载sakila数据库结构文件和数据文件：https://dev.MySQL.com/doc/index-other.html 查询...","permalink":"/post/Mysql高性能笔记","photos":[],"count_time":{"symbolsCount":"18k","symbolsTime":"16 mins."},"categories":[{"name":"MySQL","slug":"MySQL","count":3,"path":"api/categories/MySQL.json"}],"tags":[{"name":"MySQL","slug":"MySQL","count":2,"path":"api/tags/MySQL.json"}],"author":{"name":"Twitf","slug":"blog-author","avatar":"/img/avatar.png","link":"/","description":"<p>To Win In The Future.</p> <p>赢<b>在</b>未来。</p>","socials":{"github":"https://github.com/twitf","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}