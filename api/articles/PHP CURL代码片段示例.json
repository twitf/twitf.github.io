{"title":"PHP CURL代码片段示例","uid":"718913996027c0dbcc95c55f7e1981be","slug":"PHP CURL代码片段示例","date":"2022-12-26T06:39:34.000Z","updated":"2023-09-12T05:50:09.124Z","comments":true,"path":"api/articles/PHP CURL代码片段示例.json","keywords":null,"cover":null,"content":"<div class=\"language-php\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">php</span><pre class=\"shiki One Dark Pro\" style=\"background-color: #282c34\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #56B6C2\">&lt;</span><span style=\"color: #C678DD\">?</span><span style=\"color: #ABB2BF\">php  </span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">  </span></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">//请求的地址  </span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">$url</span><span style=\"color: #ABB2BF\">  </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #98C379\">&quot;xxx.com&quot;</span><span style=\"color: #ABB2BF\">;  </span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">$data</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> [];  </span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">$type</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #98C379\">&quot;&quot;</span><span style=\"color: #ABB2BF\">;  </span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">$curl</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">curl_init</span><span style=\"color: #ABB2BF\">();  </span></span>\n<span class=\"line\"><span style=\"color: #56B6C2\">curl_setopt</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">$curl</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #61AFEF\"> </span><span style=\"color: #ABB2BF\">CURLOPT_URL,</span><span style=\"color: #61AFEF\"> </span><span style=\"color: #E06C75\">$url</span><span style=\"color: #ABB2BF\">);        </span><span style=\"color: #7F848E; font-style: italic\">//设置请求链接  </span></span>\n<span class=\"line\"><span style=\"color: #56B6C2\">curl_setopt</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">$curl</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #61AFEF\"> </span><span style=\"color: #ABB2BF\">CURLOPT_RETURNTRANSFER,</span><span style=\"color: #61AFEF\"> </span><span style=\"color: #D19A66\">1</span><span style=\"color: #ABB2BF\">);</span><span style=\"color: #7F848E; font-style: italic\">//不直接输出页面  </span></span>\n<span class=\"line\"><span style=\"color: #56B6C2\">curl_setopt</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">$curl</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #61AFEF\"> </span><span style=\"color: #ABB2BF\">CURLOPT_HEADER,</span><span style=\"color: #61AFEF\"> </span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\">);        </span><span style=\"color: #7F848E; font-style: italic\">//获取响应头向下  </span></span>\n<span class=\"line\"><span style=\"color: #56B6C2\">curl_setopt</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">$curl</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #61AFEF\"> </span><span style=\"color: #ABB2BF\">CURLOPT_TIMEOUT,</span><span style=\"color: #61AFEF\"> </span><span style=\"color: #D19A66\">60</span><span style=\"color: #ABB2BF\">);      </span><span style=\"color: #7F848E; font-style: italic\">//请求超时时间，单位：秒  </span></span>\n<span class=\"line\"><span style=\"color: #56B6C2\">curl_setopt</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">$curl</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #61AFEF\"> </span><span style=\"color: #ABB2BF\">CURLOPT_USERAGENT,</span><span style=\"color: #61AFEF\"> </span><span style=\"color: #98C379\">&#39;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1&#39;</span><span style=\"color: #ABB2BF\">);  </span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">if</span><span style=\"color: #ABB2BF\"> (</span><span style=\"color: #56B6C2\">substr</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">$url</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #61AFEF\"> </span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #61AFEF\"> </span><span style=\"color: #D19A66\">5</span><span style=\"color: #ABB2BF\">) </span><span style=\"color: #56B6C2\">==</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #98C379\">&#39;https&#39;</span><span style=\"color: #ABB2BF\">) &#123;                    </span><span style=\"color: #7F848E; font-style: italic\">//自动判断是否是https提交  </span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #56B6C2\">curl_setopt</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">$curl</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #61AFEF\"> </span><span style=\"color: #ABB2BF\">CURLOPT_SSL_VERIFYPEER,</span><span style=\"color: #61AFEF\"> </span><span style=\"color: #D19A66\">false</span><span style=\"color: #ABB2BF\">);  </span><span style=\"color: #7F848E; font-style: italic\">// https请求 不验证证书和hosts  </span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #56B6C2\">curl_setopt</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">$curl</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #61AFEF\"> </span><span style=\"color: #ABB2BF\">CURLOPT_SSL_VERIFYHOST,</span><span style=\"color: #61AFEF\"> </span><span style=\"color: #D19A66\">false</span><span style=\"color: #ABB2BF\">);  </span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">&#125;  </span></span>\n<span class=\"line\"><span style=\"color: #56B6C2\">curl_setopt</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">$curl</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #61AFEF\"> </span><span style=\"color: #ABB2BF\">CURLOPT_HTTPHEADER,</span><span style=\"color: #61AFEF\"> </span><span style=\"color: #ABB2BF\">[</span><span style=\"color: #98C379\">&#39;Content-Type:application/json&#39;</span><span style=\"color: #ABB2BF\">]);  </span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">switch</span><span style=\"color: #ABB2BF\"> (</span><span style=\"color: #E06C75\">$type</span><span style=\"color: #ABB2BF\">) &#123;  </span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #C678DD\">case</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #98C379\">&quot;GET&quot;</span><span style=\"color: #ABB2BF\"> :  </span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #56B6C2\">curl_setopt</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">$curl</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #61AFEF\"> </span><span style=\"color: #ABB2BF\">CURLOPT_HTTPGET,</span><span style=\"color: #61AFEF\"> </span><span style=\"color: #D19A66\">true</span><span style=\"color: #ABB2BF\">);  </span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #C678DD\">break</span><span style=\"color: #ABB2BF\">;  </span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #C678DD\">case</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #98C379\">&quot;POST&quot;</span><span style=\"color: #ABB2BF\">:  </span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #56B6C2\">curl_setopt</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">$curl</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #61AFEF\"> </span><span style=\"color: #ABB2BF\">CURLOPT_POST,</span><span style=\"color: #61AFEF\"> </span><span style=\"color: #D19A66\">true</span><span style=\"color: #ABB2BF\">);  </span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #56B6C2\">curl_setopt</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">$curl</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #61AFEF\"> </span><span style=\"color: #ABB2BF\">CURLOPT_POSTFIELDS,</span><span style=\"color: #61AFEF\"> </span><span style=\"color: #56B6C2\">json_encode</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">$data</span><span style=\"color: #ABB2BF\">));  </span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #C678DD\">break</span><span style=\"color: #ABB2BF\">;  </span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #C678DD\">case</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #98C379\">&quot;PUT&quot;</span><span style=\"color: #ABB2BF\"> :  </span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #56B6C2\">curl_setopt</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">$curl</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #61AFEF\"> </span><span style=\"color: #ABB2BF\">CURLOPT_CUSTOMREQUEST,</span><span style=\"color: #61AFEF\"> </span><span style=\"color: #98C379\">&quot;PUT&quot;</span><span style=\"color: #ABB2BF\">);  </span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #56B6C2\">curl_setopt</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">$curl</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #61AFEF\"> </span><span style=\"color: #ABB2BF\">CURLOPT_POSTFIELDS,</span><span style=\"color: #61AFEF\"> </span><span style=\"color: #56B6C2\">json_encode</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">$data</span><span style=\"color: #ABB2BF\">));  </span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #C678DD\">break</span><span style=\"color: #ABB2BF\">;  </span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #C678DD\">case</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #98C379\">&quot;</span><span style=\"color: #C678DD\">DELETE</span><span style=\"color: #98C379\">&quot;</span><span style=\"color: #ABB2BF\">:  </span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #56B6C2\">curl_setopt</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">$curl</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #61AFEF\"> </span><span style=\"color: #ABB2BF\">CURLOPT_CUSTOMREQUEST,</span><span style=\"color: #61AFEF\"> </span><span style=\"color: #98C379\">&quot;</span><span style=\"color: #C678DD\">DELETE</span><span style=\"color: #98C379\">&quot;</span><span style=\"color: #ABB2BF\">);  </span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #56B6C2\">curl_setopt</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">$curl</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #61AFEF\"> </span><span style=\"color: #ABB2BF\">CURLOPT_POSTFIELDS,</span><span style=\"color: #61AFEF\"> </span><span style=\"color: #56B6C2\">json_encode</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">$data</span><span style=\"color: #ABB2BF\">));  </span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #C678DD\">break</span><span style=\"color: #ABB2BF\">;  </span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">&#125;  </span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">$result</span><span style=\"color: #ABB2BF\">   </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">curl_exec</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">$curl</span><span style=\"color: #ABB2BF\">);  </span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">$err_code</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">curl_errno</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">$curl</span><span style=\"color: #ABB2BF\">);  </span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">$curlInfo</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">curl_getinfo</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">$curl</span><span style=\"color: #ABB2BF\">);  </span></span>\n<span class=\"line\"><span style=\"color: #56B6C2\">curl_close</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">$curl</span><span style=\"color: #ABB2BF\">);  </span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">  </span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">if</span><span style=\"color: #ABB2BF\"> (</span><span style=\"color: #E06C75\">$err_code</span><span style=\"color: #ABB2BF\">) &#123;  </span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #C678DD\">return</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #D19A66\">false</span><span style=\"color: #ABB2BF\">;  </span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">&#125;  </span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">if</span><span style=\"color: #ABB2BF\"> (</span><span style=\"color: #E06C75\">$curlInfo</span><span style=\"color: #ABB2BF\">[</span><span style=\"color: #98C379\">&#39;http_code&#39;</span><span style=\"color: #ABB2BF\">] </span><span style=\"color: #56B6C2\">==</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #D19A66\">200</span><span style=\"color: #ABB2BF\">) &#123; </span><span style=\"color: #7F848E; font-style: italic\">//只有200状态才返回数据  </span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #56B6C2\">var_dump</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">$result</span><span style=\"color: #ABB2BF\">);  </span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">&#125;</span></span></code></pre></div>","text":"php&lt;?php //请求的地址 $url = &quot;xxx.com&quot;; $data = []; $type = &quot;&quot;...","permalink":"/post/PHP CURL代码片段示例","photos":[],"count_time":{"symbolsCount":"1.7k","symbolsTime":"2 mins."},"categories":[{"name":"PHP","slug":"PHP","count":6,"path":"api/categories/PHP.json"}],"tags":[{"name":"CURL","slug":"CURL","count":1,"path":"api/tags/CURL.json"}],"toc":"","author":{"name":"Twitf","slug":"blog-author","avatar":"/img/avatar.png","link":"/","description":"<p>To Win In The Future.</p> <p>赢<b>在</b>未来。</p>","socials":{"github":"https://github.com/twitf","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"Validator特殊验证规则","uid":"bb4cb1f0099e41d9c6f60e725ccc90c4","slug":"Validator特殊验证规则","date":"2022-12-26T06:40:34.000Z","updated":"2022-12-26T06:40:37.420Z","comments":true,"path":"api/articles/Validator特殊验证规则.json","keywords":null,"cover":null,"text":"https://learnku.com/docs/laravel/8.5/validation/10378#bec30b ","permalink":"/post/Validator特殊验证规则","photos":[],"count_time":{"symbolsCount":61,"symbolsTime":"1 mins."},"categories":[{"name":"PHP","slug":"PHP","count":6,"path":"api/categories/PHP.json"}],"tags":[{"name":"Validator","slug":"Validator","count":1,"path":"api/tags/Validator.json"}],"author":{"name":"Twitf","slug":"blog-author","avatar":"/img/avatar.png","link":"/","description":"<p>To Win In The Future.</p> <p>赢<b>在</b>未来。</p>","socials":{"github":"https://github.com/twitf","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"Docker设置镜像加速","uid":"5d7ce46638bdc7bb6d0235a8c7e00e59","slug":"Docker设置镜像加速","date":"2022-10-26T03:50:34.000Z","updated":"2022-10-26T07:04:08.886Z","comments":true,"path":"api/articles/Docker设置镜像加速.json","keywords":null,"cover":null,"text":"配置文件添加json&#123; &quot;registry-mirrors&quot;: [&quot;https://vxkym11s.mirror.al...","permalink":"/post/Docker设置镜像加速","photos":[],"count_time":{"symbolsCount":106,"symbolsTime":"1 mins."},"categories":[{"name":"Docker","slug":"Docker","count":2,"path":"api/categories/Docker.json"}],"tags":[{"name":"Docker","slug":"Docker","count":2,"path":"api/tags/Docker.json"}],"author":{"name":"Twitf","slug":"blog-author","avatar":"/img/avatar.png","link":"/","description":"<p>To Win In The Future.</p> <p>赢<b>在</b>未来。</p>","socials":{"github":"https://github.com/twitf","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}