{"title":"PHP CURL代码片段示例","uid":"718913996027c0dbcc95c55f7e1981be","slug":"PHP CURL代码片段示例","date":"2022-12-26T06:39:34.000Z","updated":"2023-09-12T05:50:09.124Z","comments":true,"path":"api/articles/PHP CURL代码片段示例.json","keywords":null,"cover":null,"content":"<div class=\"language-php\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">php</span><pre class=\"shiki material-theme-darker\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #89DDFF\">&lt;?</span><span style=\"color: #EEFFFF\">php  </span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">  </span></span>\n<span class=\"line\"><span style=\"color: #545454; font-style: italic\">//请求的地址  </span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">$</span><span style=\"color: #EEFFFF\">url  </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">xxx.com</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">;</span><span style=\"color: #EEFFFF\">  </span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">$</span><span style=\"color: #EEFFFF\">data </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">[];</span><span style=\"color: #EEFFFF\">  </span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">$</span><span style=\"color: #EEFFFF\">type </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">&quot;&quot;</span><span style=\"color: #89DDFF\">;</span><span style=\"color: #EEFFFF\">  </span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">$</span><span style=\"color: #EEFFFF\">curl </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #82AAFF\">curl_init</span><span style=\"color: #89DDFF\">();</span><span style=\"color: #EEFFFF\">  </span></span>\n<span class=\"line\"><span style=\"color: #82AAFF\">curl_setopt</span><span style=\"color: #89DDFF\">($</span><span style=\"color: #EEFFFF\">curl</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #EEFFFF\"> CURLOPT_URL</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">$</span><span style=\"color: #EEFFFF\">url</span><span style=\"color: #89DDFF\">);</span><span style=\"color: #EEFFFF\">        </span><span style=\"color: #545454; font-style: italic\">//设置请求链接  </span></span>\n<span class=\"line\"><span style=\"color: #82AAFF\">curl_setopt</span><span style=\"color: #89DDFF\">($</span><span style=\"color: #EEFFFF\">curl</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #EEFFFF\"> CURLOPT_RETURNTRANSFER</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #F78C6C\">1</span><span style=\"color: #89DDFF\">);</span><span style=\"color: #545454; font-style: italic\">//不直接输出页面  </span></span>\n<span class=\"line\"><span style=\"color: #82AAFF\">curl_setopt</span><span style=\"color: #89DDFF\">($</span><span style=\"color: #EEFFFF\">curl</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #EEFFFF\"> CURLOPT_HEADER</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #F78C6C\">0</span><span style=\"color: #89DDFF\">);</span><span style=\"color: #EEFFFF\">        </span><span style=\"color: #545454; font-style: italic\">//获取响应头向下  </span></span>\n<span class=\"line\"><span style=\"color: #82AAFF\">curl_setopt</span><span style=\"color: #89DDFF\">($</span><span style=\"color: #EEFFFF\">curl</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #EEFFFF\"> CURLOPT_TIMEOUT</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #F78C6C\">60</span><span style=\"color: #89DDFF\">);</span><span style=\"color: #EEFFFF\">      </span><span style=\"color: #545454; font-style: italic\">//请求超时时间，单位：秒  </span></span>\n<span class=\"line\"><span style=\"color: #82AAFF\">curl_setopt</span><span style=\"color: #89DDFF\">($</span><span style=\"color: #EEFFFF\">curl</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #EEFFFF\"> CURLOPT_USERAGENT</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">);</span><span style=\"color: #EEFFFF\">  </span></span>\n<span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">substr</span><span style=\"color: #89DDFF\">($</span><span style=\"color: #EEFFFF\">url</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #F78C6C\">0</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #F78C6C\">5</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">==</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">https</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">&#123;</span><span style=\"color: #EEFFFF\">                    </span><span style=\"color: #545454; font-style: italic\">//自动判断是否是https提交  </span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">    </span><span style=\"color: #82AAFF\">curl_setopt</span><span style=\"color: #89DDFF\">($</span><span style=\"color: #EEFFFF\">curl</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #EEFFFF\"> CURLOPT_SSL_VERIFYPEER</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">false);</span><span style=\"color: #EEFFFF\">  </span><span style=\"color: #545454; font-style: italic\">// https请求 不验证证书和hosts  </span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">    </span><span style=\"color: #82AAFF\">curl_setopt</span><span style=\"color: #89DDFF\">($</span><span style=\"color: #EEFFFF\">curl</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #EEFFFF\"> CURLOPT_SSL_VERIFYHOST</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">false);</span><span style=\"color: #EEFFFF\">  </span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">&#125;</span><span style=\"color: #EEFFFF\">  </span></span>\n<span class=\"line\"><span style=\"color: #82AAFF\">curl_setopt</span><span style=\"color: #89DDFF\">($</span><span style=\"color: #EEFFFF\">curl</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #EEFFFF\"> CURLOPT_HTTPHEADER</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">[</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">Content-Type:application/json</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">]);</span><span style=\"color: #EEFFFF\">  </span></span>\n<span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">switch</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">($</span><span style=\"color: #EEFFFF\">type</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">&#123;</span><span style=\"color: #EEFFFF\">  </span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">    </span><span style=\"color: #89DDFF; font-style: italic\">case</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">GET</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">:</span><span style=\"color: #EEFFFF\">  </span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">        </span><span style=\"color: #82AAFF\">curl_setopt</span><span style=\"color: #89DDFF\">($</span><span style=\"color: #EEFFFF\">curl</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #EEFFFF\"> CURLOPT_HTTPGET</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">true);</span><span style=\"color: #EEFFFF\">  </span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">        </span><span style=\"color: #89DDFF; font-style: italic\">break</span><span style=\"color: #89DDFF\">;</span><span style=\"color: #EEFFFF\">  </span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">    </span><span style=\"color: #89DDFF; font-style: italic\">case</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">POST</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #EEFFFF\">  </span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">        </span><span style=\"color: #82AAFF\">curl_setopt</span><span style=\"color: #89DDFF\">($</span><span style=\"color: #EEFFFF\">curl</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #EEFFFF\"> CURLOPT_POST</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">true);</span><span style=\"color: #EEFFFF\">  </span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">        </span><span style=\"color: #82AAFF\">curl_setopt</span><span style=\"color: #89DDFF\">($</span><span style=\"color: #EEFFFF\">curl</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #EEFFFF\"> CURLOPT_POSTFIELDS</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #82AAFF\">json_encode</span><span style=\"color: #89DDFF\">($</span><span style=\"color: #EEFFFF\">data</span><span style=\"color: #89DDFF\">));</span><span style=\"color: #EEFFFF\">  </span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">        </span><span style=\"color: #89DDFF; font-style: italic\">break</span><span style=\"color: #89DDFF\">;</span><span style=\"color: #EEFFFF\">  </span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">    </span><span style=\"color: #89DDFF; font-style: italic\">case</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">PUT</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">:</span><span style=\"color: #EEFFFF\">  </span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">        </span><span style=\"color: #82AAFF\">curl_setopt</span><span style=\"color: #89DDFF\">($</span><span style=\"color: #EEFFFF\">curl</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #EEFFFF\"> CURLOPT_CUSTOMREQUEST</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">PUT</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">);</span><span style=\"color: #EEFFFF\">  </span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">        </span><span style=\"color: #82AAFF\">curl_setopt</span><span style=\"color: #89DDFF\">($</span><span style=\"color: #EEFFFF\">curl</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #EEFFFF\"> CURLOPT_POSTFIELDS</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #82AAFF\">json_encode</span><span style=\"color: #89DDFF\">($</span><span style=\"color: #EEFFFF\">data</span><span style=\"color: #89DDFF\">));</span><span style=\"color: #EEFFFF\">  </span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">        </span><span style=\"color: #89DDFF; font-style: italic\">break</span><span style=\"color: #89DDFF\">;</span><span style=\"color: #EEFFFF\">  </span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">    </span><span style=\"color: #89DDFF; font-style: italic\">case</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #F78C6C\">DELETE</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #EEFFFF\">  </span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">        </span><span style=\"color: #82AAFF\">curl_setopt</span><span style=\"color: #89DDFF\">($</span><span style=\"color: #EEFFFF\">curl</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #EEFFFF\"> CURLOPT_CUSTOMREQUEST</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #F78C6C\">DELETE</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">);</span><span style=\"color: #EEFFFF\">  </span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">        </span><span style=\"color: #82AAFF\">curl_setopt</span><span style=\"color: #89DDFF\">($</span><span style=\"color: #EEFFFF\">curl</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #EEFFFF\"> CURLOPT_POSTFIELDS</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #82AAFF\">json_encode</span><span style=\"color: #89DDFF\">($</span><span style=\"color: #EEFFFF\">data</span><span style=\"color: #89DDFF\">));</span><span style=\"color: #EEFFFF\">  </span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">        </span><span style=\"color: #89DDFF; font-style: italic\">break</span><span style=\"color: #89DDFF\">;</span><span style=\"color: #EEFFFF\">  </span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">&#125;</span><span style=\"color: #EEFFFF\">  </span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">$</span><span style=\"color: #EEFFFF\">result   </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #82AAFF\">curl_exec</span><span style=\"color: #89DDFF\">($</span><span style=\"color: #EEFFFF\">curl</span><span style=\"color: #89DDFF\">);</span><span style=\"color: #EEFFFF\">  </span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">$</span><span style=\"color: #EEFFFF\">err_code </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #82AAFF\">curl_errno</span><span style=\"color: #89DDFF\">($</span><span style=\"color: #EEFFFF\">curl</span><span style=\"color: #89DDFF\">);</span><span style=\"color: #EEFFFF\">  </span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">$</span><span style=\"color: #EEFFFF\">curlInfo </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #82AAFF\">curl_getinfo</span><span style=\"color: #89DDFF\">($</span><span style=\"color: #EEFFFF\">curl</span><span style=\"color: #89DDFF\">);</span><span style=\"color: #EEFFFF\">  </span></span>\n<span class=\"line\"><span style=\"color: #82AAFF\">curl_close</span><span style=\"color: #89DDFF\">($</span><span style=\"color: #EEFFFF\">curl</span><span style=\"color: #89DDFF\">);</span><span style=\"color: #EEFFFF\">  </span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">  </span></span>\n<span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">($</span><span style=\"color: #EEFFFF\">err_code</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">&#123;</span><span style=\"color: #EEFFFF\">  </span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">    </span><span style=\"color: #89DDFF; font-style: italic\">return</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">false;</span><span style=\"color: #EEFFFF\">  </span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">&#125;</span><span style=\"color: #EEFFFF\">  </span></span>\n<span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">($</span><span style=\"color: #EEFFFF\">curlInfo</span><span style=\"color: #89DDFF\">[</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">http_code</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">]</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">==</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #F78C6C\">200</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #89DDFF\">&#123;</span><span style=\"color: #EEFFFF\"> </span><span style=\"color: #545454; font-style: italic\">//只有200状态才返回数据  </span></span>\n<span class=\"line\"><span style=\"color: #EEFFFF\">    </span><span style=\"color: #82AAFF\">var_dump</span><span style=\"color: #89DDFF\">($</span><span style=\"color: #EEFFFF\">result</span><span style=\"color: #89DDFF\">);</span><span style=\"color: #EEFFFF\">  </span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">&#125;</span></span></code></pre></div>","text":"php&lt;?php //请求的地址 $url = &quot;xxx.com&quot;; $data = []; $type = &quot;&quot;...","permalink":"/post/PHP CURL代码片段示例","photos":[],"count_time":{"symbolsCount":"1.7k","symbolsTime":"2 mins."},"categories":[{"name":"PHP","slug":"PHP","count":6,"path":"api/categories/PHP.json"}],"tags":[{"name":"CURL","slug":"CURL","count":1,"path":"api/tags/CURL.json"}],"toc":"","author":{"name":"Twitf","slug":"blog-author","avatar":"/img/avatar.png","link":"/","description":"To Win In The Future","socials":{"github":"https://github.com/twitf","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"Validator特殊验证规则","uid":"bb4cb1f0099e41d9c6f60e725ccc90c4","slug":"Validator特殊验证规则","date":"2022-12-26T06:40:34.000Z","updated":"2022-12-26T06:40:37.420Z","comments":true,"path":"api/articles/Validator特殊验证规则.json","keywords":null,"cover":null,"text":"https://learnku.com/docs/laravel/8.5/validation/10378#bec30b ","permalink":"/post/Validator特殊验证规则","photos":[],"count_time":{"symbolsCount":61,"symbolsTime":"1 mins."},"categories":[{"name":"PHP","slug":"PHP","count":6,"path":"api/categories/PHP.json"}],"tags":[{"name":"Validator","slug":"Validator","count":1,"path":"api/tags/Validator.json"}],"author":{"name":"Twitf","slug":"blog-author","avatar":"/img/avatar.png","link":"/","description":"To Win In The Future","socials":{"github":"https://github.com/twitf","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"Docker设置镜像加速","uid":"5d7ce46638bdc7bb6d0235a8c7e00e59","slug":"Docker设置镜像加速","date":"2022-10-26T03:50:34.000Z","updated":"2022-10-26T07:04:08.886Z","comments":true,"path":"api/articles/Docker设置镜像加速.json","keywords":null,"cover":null,"text":"配置文件添加json&#123; &quot;registry-mirrors&quot;: [&quot;https://vxkym11s.mirror.al...","permalink":"/post/Docker设置镜像加速","photos":[],"count_time":{"symbolsCount":106,"symbolsTime":"1 mins."},"categories":[{"name":"Docker","slug":"Docker","count":2,"path":"api/categories/Docker.json"}],"tags":[{"name":"Docker","slug":"Docker","count":2,"path":"api/tags/Docker.json"}],"author":{"name":"Twitf","slug":"blog-author","avatar":"/img/avatar.png","link":"/","description":"To Win In The Future","socials":{"github":"https://github.com/twitf","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}